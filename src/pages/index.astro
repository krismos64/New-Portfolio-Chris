---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import Hero from '../components/Hero.astro';
import About from '../components/About.astro';
import Skills from '../components/Skills.astro';
import Projects from '../components/Projects.astro';
import Articles from '../components/Articles.astro';
---

<Layout title="Portfolio Christophe Mostefaoui">
  <Navigation />
  <main id="main-content">
    <Hero />
    <About />
    <Skills />
    <Projects />
    <Articles />

    <section id="contact">
      <h2 class="section-title">Contact</h2>
      <div class="contact-container">
        <div class="profile-bubble" data-aos="zoom-in">
          <img src="/images/portfolio/chris6.jpg" alt="Christophe Mostefaoui" class="profile-picture" />
          <div class="profile-glow"></div>
        </div>

        <div class="speech-bubble" data-aos="fade-up" data-aos-delay="200">
          <p>N'hésitez pas à me contacter pour plus de renseignements. Je serais ravis de m'entretenir avec vous.</p>
        </div>

        <div class="contact-grid">
          <a href="tel:+33679088845" class="contact-card" data-aos="fade-up" data-aos-delay="200">
            <div class="contact-icon"><i class="fas fa-phone"></i></div>
            <div class="contact-content">
              <h3>Téléphone</h3>
              <p>+33 6 79 08 88 45</p>
            </div>
          </a>

          <a href="mailto:christophe.mostefaoui.dev@gmail.com" class="contact-card" data-aos="fade-up" data-aos-delay="300">
            <div class="contact-icon"><i class="fas fa-envelope"></i></div>
            <div class="contact-content">
              <h3>Email</h3>
              <p>christophe.mostefaoui.dev@gmail.com</p>
            </div>
          </a>

          <div class="contact-card" data-aos="fade-up" data-aos-delay="400">
            <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
            <div class="contact-content">
              <h3>Localisation</h3>
              <p>Artix (64170), France</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>Copyright © 2025 Portfolio. Christophe Mostefaoui</p>
  </footer>

  <!-- Modals -->
  <div class="video-modal" id="videoModal">
    <div class="video-modal-content">
      <div class="corner-effect top-left"></div>
      <div class="corner-effect top-right"></div>
      <div class="corner-effect bottom-left"></div>
      <div class="corner-effect bottom-right"></div>

      <button class="video-modal-close" id="closeVideoModal" type="button" aria-label="Fermer la vidéo">
        <i class="fas fa-times"></i>
      </button>

      <div class="video-wrapper" id="videoWrapper">
        <div class="video-placeholder">
          <img src="/images/portfolio/miniature.jpg" alt="Prévisualisation vidéo" class="placeholder-image" />
          <div class="video-loading">
            <div class="loader"></div>
            <span>Chargement...</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script>
  // Scripts d'initialisation
  document.addEventListener('DOMContentLoaded', () => {
    // Création des étoiles
    const container = document.getElementById("stars");
    if (container) {
      container.innerHTML = "";
      
      function createStarBatch(count, className) {
        const fragment = document.createDocumentFragment();
        for (let i = 0; i < count; i++) {
          const star = document.createElement("div");
          star.className = className;
          star.style.left = Math.random() * 100 + "%";
          star.style.top = Math.random() * 100 + "%";
          star.style.animationDuration = Math.random() * 30 + 30 + "s";
          star.style.animationDelay = Math.random() * 15 + "s";
          fragment.appendChild(star);
        }
        return fragment;
      }

      container.appendChild(createStarBatch(50, "star"));
      container.appendChild(createStarBatch(50, "star bright"));
      container.appendChild(createStarBatch(50, "star purple"));
    }

    // Initialisation AOS
    if (window.AOS) {
      AOS.init({
        duration: 800,
        once: true,
        offset: 120,
      });
    }

    // Vidéo modal
    const videoFrame = document.querySelector(".video-frame");
    const videoModal = document.getElementById("videoModal");
    const closeBtn = document.getElementById("closeVideoModal");

    if (videoFrame && videoModal) {
      videoFrame.addEventListener("click", function () {
        const videoId = "oxEya9SYYpQ";
        const videoWrapper = document.getElementById("videoWrapper");
        
        videoModal.style.display = "flex";
        
        setTimeout(function () {
          const videoUrl = `https://www.youtube-nocookie.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1`;
          const iframe = document.createElement("iframe");
          iframe.width = "100%";
          iframe.height = "100%";
          iframe.style.position = "absolute";
          iframe.style.top = "0";
          iframe.style.left = "0";
          iframe.frameBorder = "0";
          iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
          iframe.allowFullscreen = true;
          iframe.loading = "lazy";
          iframe.title = "Vidéo de présentation de Christophe Mostefaoui";
          iframe.src = videoUrl;

          iframe.onload = function () {
            iframe.classList.add("loaded");
            const placeholder = videoWrapper.querySelector(".video-placeholder");
            if (placeholder) placeholder.style.display = "none";
          };

          videoWrapper.appendChild(iframe);
        }, 100);
      });
    }

    if (closeBtn) {
      closeBtn.addEventListener("click", () => {
        videoModal.style.display = "none";
        const videoWrapper = document.getElementById("videoWrapper");
        const iframe = videoWrapper.querySelector("iframe");
        if (iframe) {
          iframe.src = "";
          iframe.remove();
        }
        const placeholder = videoWrapper.querySelector(".video-placeholder");
        if (placeholder) placeholder.style.display = "flex";
      });
    }
  });
</script>